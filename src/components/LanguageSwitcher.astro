---
/**
 * 语言切换组件 — 纯图标版（与搜索/主题切换风格一致）
 */
import { getLocaleFromPath, getLocalizedPath } from "@/utils/i18n";

const currentPath = Astro.url.pathname;
const currentLocale = getLocaleFromPath(currentPath);
const targetLocale = currentLocale === "en" ? "zh-CN" : "en";
const targetPath = getLocalizedPath(currentPath, targetLocale);
const isEnglish = currentLocale === "en";
---

<a
    href={targetPath}
    class="lang-icon-btn ms-2 sm:ms-4"
    aria-label={isEnglish ? "切换到中文" : "Switch to English"}
    title={isEnglish ? "切换到中文" : "Switch to English"}
>
    {isEnglish ? (
        <!-- 甲骨文「文」: top nub + diamond with extended 'hands' + crossed legs -->
        <svg
            class="lang-icon oracle-wen"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="1.3"
            stroke-linecap="round"
            stroke-linejoin="round"
            xmlns="http://www.w3.org/2000/svg"
            aria-hidden="true"
        >
            <!-- Top vertical nub -->
            <line x1="12" y1="2" x2="12" y2="5" />
            
            <!-- Diamond Top Sides (Roof) - extending past the corners for 'hands' -->
            <!-- Top to Left-Extension -->
            <line x1="12" y1="5" x2="4" y2="13" />
            <!-- Top to Right-Extension -->
            <line x1="12" y1="5" x2="20" y2="13" />
            
            <!-- Diamond Bottom Sides -->
            <!-- Left-Corner to Bottom -->
            <line x1="6" y1="11" x2="12" y2="17" />
            <!-- Right-Corner to Bottom -->
            <line x1="18" y1="11" x2="12" y2="17" />

            <!-- Center dot -->
            <circle cx="12" cy="11" r="1" fill="currentColor" stroke="none" />
            
            <!-- Crossed Legs starting from the corners (6,11) and (18,11) -->
            <line x1="6" y1="11" x2="16" y2="22.5" />
            <line x1="18" y1="11" x2="8" y2="22.5" />
        </svg>
    ) : (
        <!-- 「A」letterform shown on Chinese pages -->
        <svg
            class="lang-icon"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="1.25"
            stroke-linecap="round"
            stroke-linejoin="round"
            xmlns="http://www.w3.org/2000/svg"
            aria-hidden="true"
        >
            <path d="M4 20 L12 4 L20 20" />
            <line x1="7" y1="13.5" x2="17" y2="13.5" />
        </svg>
    )}

</a>

<style>
    .lang-icon-btn {
        display: flex;
        align-items: center;
        justify-content: center;
        width: 2rem;
        height: 2rem;
        border-radius: 0.375rem;
        color: var(--academia-muted-fg);
        transition: color 200ms ease, transform 200ms ease;
        text-decoration: none;
    }

    .lang-icon-btn:hover {
        color: var(--academia-brass);
        transform: scale(1.1);
    }

    .lang-icon {
        width: 1.2rem;
        height: 1.2rem;
    }
</style>
