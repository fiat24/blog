<theme-toggle class="relative ms-2 sm:ms-4">
	<button
		class="icon-btn"
		type="button"
		aria-label="Toggle theme"
	>
		<span class="sr-only">Toggle Theme</span>
		<!-- Sun icon (shown in light mode) -->
		<svg
			aria-hidden="true"
			class="icon icon-sun scale-100 opacity-100 dark:scale-0 dark:opacity-0"
			fill="none"
			focusable="false"
			id="sun-svg"
			stroke="currentColor"
			stroke-width="1.25"
			viewBox="0 0 24 24"
			xmlns="http://www.w3.org/2000/svg"
		>
			<!-- Center circle -->
			<circle cx="12" cy="12" r="4.5"></circle>
			<!-- Rays â€” 8 short dots around the circle -->
			<line x1="12" y1="2" x2="12" y2="4.5" stroke-linecap="round"></line>
			<line x1="12" y1="19.5" x2="12" y2="22" stroke-linecap="round"></line>
			<line x1="2" y1="12" x2="4.5" y2="12" stroke-linecap="round"></line>
			<line x1="19.5" y1="12" x2="22" y2="12" stroke-linecap="round"></line>
			<line x1="4.93" y1="4.93" x2="6.64" y2="6.64" stroke-linecap="round"></line>
			<line x1="17.36" y1="17.36" x2="19.07" y2="19.07" stroke-linecap="round"></line>
			<line x1="19.07" y1="4.93" x2="17.36" y2="6.64" stroke-linecap="round"></line>
			<line x1="6.64" y1="17.36" x2="4.93" y2="19.07" stroke-linecap="round"></line>
		</svg>
		<!-- Moon icon (shown in dark mode) -->
		<svg
			aria-hidden="true"
			class="icon icon-moon absolute inset-0 m-auto scale-0 opacity-0 dark:scale-100 dark:opacity-100"
			fill="none"
			focusable="false"
			id="moon-svg"
			stroke="currentColor"
			stroke-width="1.25"
			viewBox="0 0 24 24"
			xmlns="http://www.w3.org/2000/svg"
		>
			<path
				d="M21 12.79A9 9 0 1 1 11.21 3a7 7 0 0 0 9.79 9.79z"
				stroke-linecap="round"
				stroke-linejoin="round"
			></path>
		</svg>
	</button>
</theme-toggle>

<script>
	import { rootInDarkMode } from "@/utils/domElement";

	class ThemeToggle extends HTMLElement {
		connectedCallback() {
			const button = this.querySelector<HTMLButtonElement>("button")!;
			button.setAttribute("role", "switch");
			button.setAttribute("aria-checked", String(rootInDarkMode()));

			button.addEventListener("click", () => {
				let themeChangeEvent = new CustomEvent("theme-change", {
					detail: {
						theme: rootInDarkMode() ? "light" : "dark",
					},
				});
				document.dispatchEvent(themeChangeEvent);
				button.setAttribute("aria-checked", String(rootInDarkMode()));
			});
		}
	}

	customElements.define("theme-toggle", ThemeToggle);
</script>

<style>
	.icon-btn {
		display: flex;
		align-items: center;
		justify-content: center;
		width: 2rem;
		height: 2rem;
		border-radius: 0.375rem;
		color: var(--academia-muted-fg);
		transition: color 200ms ease, transform 200ms ease;
		position: relative;
	}

	.icon-btn:hover {
		color: var(--academia-brass);
		transform: scale(1.1);
	}

	.icon {
		width: 1.2rem;
		height: 1.2rem;
		transition: transform 300ms ease, opacity 300ms ease;
	}
</style>
